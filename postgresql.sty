\ProvidesPackage{postgresql}
\RequirePackage{cmap}
\RequirePackage{graphicx}
\RequirePackage{tabularx}
\RequirePackage{indentfirst}
\RequirePackage{mathtext}
\RequirePackage[T2A]{fontenc}
\RequirePackage[utf8]{inputenc}
\RequirePackage[russian,english]{babel}
\RequirePackage{times}
\RequirePackage[scaled]{beramono}
\RequirePackage{tgadventor}
\RequirePackage[usenames,svgnames]{xcolor}
\RequirePackage{color}
\RequirePackage{amssymb,amsmath,amsfonts}
%\RequirePackage[usenames,dvipsnames]{color}
\RequirePackage{listings}
\RequirePackage[colorlinks=true]{hyperref}
\RequirePackage{perpage} %the perpage package
\RequirePackage{wrapfig}
\RequirePackage{pdfpages} % cover image
\RequirePackage{lmodern}

\graphicspath{{images/}{schemes/}{software/}}

%\renewcommand{\familydefault}{\sfdefault}
\renewcommand{\rmdefault}{ftm}

\renewcommand{\lstlistingname}{Код}

\sloppy

\definecolor{lineno}{rgb}{0.5,0.5,0.5}
\definecolor{code}{rgb}{0,0.1,0.6}
\definecolor{keyword}{rgb}{0.5,0.1,0.1}
\definecolor{titlebox}{rgb}{0.85,0.85,0.85}
\definecolor{download}{rgb}{0.8,0.1,0.5}
\definecolor{code_title}{rgb}{0.8,0.1,0.4}
\definecolor{title}{rgb}{0.2,0.2,0.2}

\lstset{
    language=SQL,
    basicstyle=\ttfamily\small\color{code},
    showspaces=false,
    showstringspaces=false,
    breaklines=true,                 % Автоматический перенос строк
    breakatwhitespace=true,
    numbers=left,
    firstnumber=1,
    stepnumber=5,
    numberfirstline=true,
    numberstyle=\color{lineno}\sffamily\scriptsize,
    keywordstyle=\color{keyword}\bfseries,
    stringstyle=\itshape,
    morekeywords={dosync,if},
    deletekeywords={alter},
    title=Листинг,
    keepspaces=true,
    extendedchars=\true,
    inputencoding=utf8
}

\lstdefinelanguage{JavaScript}{
  keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
  keywordstyle=\color{blue}\bfseries,
  ndkeywords={class, export, boolean, throw, implements, import, this},
  ndkeywordstyle=\color{darkgray}\bfseries,
  identifierstyle=\color{black},
  sensitive=false,
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{purple}\ttfamily,
  stringstyle=\color{red}\ttfamily,
  morestring=[b]',
  morestring=[b]"
}

\makeatletter
\gdef\lst@SkipOrPrintLabel{%
    \ifnum\lst@skipnumbers=\z@
        \global\advance\lst@skipnumbers-\lst@stepnumber\relax
        \lst@PlaceNumber
        \lst@numberfirstlinefalse
    \else
        \lst@ifnumberfirstline
            {\def\thelstnumber{Line \@arabic\c@lstnumber}\lst@PlaceNumber}%
            \lst@numberfirstlinefalse
        \else
            {\def\thelstnumber{-}\lst@PlaceNumber}%
        \fi
    \fi
    \global\advance\lst@skipnumbers\@ne}%
\def\lst@maketitle#1{
   \vskip\abovecaptionskip
   \colorbox{titlebox}{
       %\scriptsize
       \small
       \color{download}\ttfamily\href{http://postgres.leopard.in.ua/codes/#1}{Скачать}
       \color{title}\sffamily\bfseries#1}
   \vskip\belowcaptionskip}
\def\lst@makecaption#1#2{
  \vskip\abovecaptionskip
  \colorbox{titlebox}{
      %\scriptsize
      \small
      \color{code_title}\ttfamily#1
      \color{title}\sffamily\bfseries#2}
  \vskip\belowcaptionskip}
\makeatother

\let\olditemize=\itemize
\def\itemize{
  \olditemize
  \setlength{\itemsep}{-1ex}
}

\let\oldenumerate=\enumerate
\def\enumerate{
  \oldenumerate
  \setlength{\itemsep}{-1ex}
}

\MakePerPage{footnote} %the perpage package command